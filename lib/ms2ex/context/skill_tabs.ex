defmodule Ms2ex.Context.SkillTabs do
  alias Ms2ex.Metadata

  @orders %{
    knight: [
      10_100_091,
      10_100_261,
      10_100_041,
      10_100_211,
      10_100_161,
      10_100_281,
      20_000_011,
      10_100_061,
      10_100_011,
      10_100_181,
      10_100_062,
      10_100_131,
      10_100_081,
      10_100_031,
      10_100_201,
      10_100_151,
      10_100_101,
      20_000_001,
      10_100_051,
      10_100_221,
      10_100_001,
      10_100_171,
      10_100_291,
      10_100_071,
      10_100_021,
      10_100_191,
      10_100_141,
      10_100_294,
      10_100_111,
      10_100_162,
      10_100_231,
      10_100_251,
      10_100_202,
      10_100_271,
      10_100_204,
      10_100_121,
      10_100_241
    ],
    berserker: [
      10_200_051,
      10_200_255,
      10_200_221,
      10_200_001,
      10_200_205,
      10_200_171,
      10_200_206,
      10_200_257,
      10_200_291,
      10_200_172,
      10_200_207,
      10_200_071,
      20_000_011,
      10_200_021,
      10_200_141,
      10_200_091,
      10_200_041,
      10_200_161,
      10_200_281,
      10_200_061,
      10_200_231,
      10_200_282,
      20_000_001,
      10_200_181,
      10_200_011,
      10_200_062,
      10_200_131,
      10_200_233,
      10_200_251,
      10_200_234,
      10_200_201,
      10_200_271,
      10_200_189,
      10_200_121,
      10_200_241,
      10_200_191,
      10_200_209,
      10_200_261,
      10_200_142,
      10_200_211,
      10_200_229,
      10_200_111,
      10_200_081,
      10_200_031,
      10_200_151,
      10_200_101,
      10_200_254
    ],
    wizard: [
      10_300_232,
      10_300_021,
      10_300_181,
      10_300_236,
      10_300_131,
      10_300_291,
      10_300_081,
      10_300_031,
      10_300_191,
      10_300_299,
      10_300_141,
      10_300_091,
      10_300_251,
      10_300_198,
      10_300_252,
      10_300_041,
      10_300_253,
      10_300_201,
      10_300_043,
      10_300_203,
      20_000_001,
      10_300_262,
      10_300_051,
      10_300_211,
      10_300_053,
      10_300_001,
      10_300_266,
      10_300_214,
      10_300_161,
      20_000_011,
      10_300_271,
      10_300_221,
      10_300_222,
      10_300_011,
      10_300_171,
      10_300_225,
      10_300_282,
      10_300_071,
      10_300_231,
      10_300_200,
      10_300_184,
      10_300_219,
      10_300_151,
      10_300_101,
      10_300_121,
      10_300_240,
      10_300_241,
      10_300_260,
      10_300_261,
      10_300_210,
      10_300_093,
      10_300_281,
      10_300_230,
      10_300_111,
      10_300_179,
      10_300_061
    ],
    priest: [
      10_400_091,
      10_400_193,
      10_400_041,
      10_400_211,
      10_400_161,
      20_000_011,
      10_400_061,
      10_400_231,
      10_400_011,
      10_400_181,
      10_400_081,
      10_400_031,
      10_400_151,
      20_000_001,
      10_400_101,
      10_400_271,
      10_400_186,
      10_400_051,
      10_400_221,
      10_400_001,
      10_400_171,
      10_400_121,
      10_400_291,
      10_400_071,
      10_400_241,
      10_400_191,
      10_400_072,
      10_400_141,
      10_400_261,
      10_400_111,
      10_400_281,
      10_400_131,
      10_400_301,
      10_400_251,
      10_400_021,
      10_400_242,
      10_400_293
    ],
    archer: [
      10_500_101,
      10_500_152,
      10_500_221,
      10_500_051,
      10_500_153,
      10_500_171,
      10_500_001,
      10_500_291,
      10_500_172,
      10_500_241,
      20_000_011,
      10_500_173,
      10_500_191,
      10_500_021,
      10_500_174,
      10_500_141,
      10_500_192,
      10_500_243,
      10_500_091,
      10_500_193,
      10_500_261,
      10_500_041,
      10_500_211,
      10_500_093,
      10_500_144,
      10_500_281,
      10_500_231,
      20_000_001,
      10_500_061,
      10_500_181,
      10_500_011,
      10_500_081,
      10_500_031,
      10_500_065,
      10_500_151,
      10_500_067,
      10_500_271,
      10_500_121,
      10_500_292,
      10_500_071,
      10_500_293,
      10_500_161,
      10_500_111,
      10_500_232,
      10_500_131,
      10_500_063,
      10_500_251,
      10_500_064,
      10_500_201
    ],
    heavy_gunner: [
      10_600_044,
      10_600_231,
      10_600_061,
      10_600_181,
      10_600_011,
      10_600_131,
      10_600_081,
      10_600_201,
      20_000_011,
      10_600_031,
      10_600_101,
      10_600_271,
      10_600_051,
      10_600_221,
      10_600_171,
      10_600_001,
      10_600_291,
      10_600_121,
      10_600_071,
      10_600_191,
      20_000_001,
      10_600_021,
      10_600_261,
      10_600_091,
      10_600_211,
      10_600_041,
      10_600_281,
      10_600_284,
      10_600_251,
      10_600_285,
      10_600_286,
      10_600_151,
      10_600_172,
      10_600_223,
      10_600_241,
      10_600_141,
      10_600_192,
      10_600_161,
      10_600_111,
      10_600_213
    ],
    thief: [
      10_700_011,
      10_700_016,
      10_700_281,
      10_700_282,
      10_700_283,
      10_700_231,
      10_700_021,
      10_700_181,
      10_700_022,
      10_700_182,
      10_700_131,
      10_700_081,
      10_700_031,
      10_700_032,
      10_700_191,
      10_700_141,
      10_700_142,
      20_000_001,
      10_700_091,
      10_700_092,
      10_700_252,
      10_700_093,
      10_700_200,
      10_700_041,
      10_700_042,
      10_700_202,
      10_700_204,
      20_000_011,
      10_700_051,
      10_700_052,
      10_700_211,
      10_700_001,
      10_700_002,
      10_700_161,
      10_700_162,
      10_700_111,
      10_700_271,
      10_700_273,
      10_700_221,
      10_700_222,
      10_700_192,
      10_700_261,
      10_700_212,
      10_700_061,
      10_700_301,
      10_700_251,
      10_700_183,
      10_700_151,
      10_700_101,
      10_700_291,
      10_700_121,
      10_700_241,
      10_700_071
    ],
    assassin: [
      10_800_101,
      10_800_271,
      10_800_203,
      10_800_051,
      10_800_221,
      10_800_001,
      10_800_171,
      20_000_011,
      10_800_121,
      10_800_291,
      10_800_071,
      10_800_021,
      10_800_191,
      10_800_293,
      10_800_141,
      10_800_261,
      10_800_041,
      10_800_211,
      10_800_161,
      10_800_229,
      20_000_001,
      10_800_281,
      10_800_061,
      10_800_231,
      10_800_011,
      10_800_181,
      10_800_131,
      10_800_081,
      10_800_031,
      10_800_201,
      10_800_151,
      10_800_052,
      10_800_241,
      10_800_091,
      10_800_111,
      10_800_163,
      10_800_232,
      10_800_251
    ],
    rune_blade: [
      10_900_033,
      10_900_193,
      01_000_005,
      10_900_034,
      01_000_007,
      10_900_196,
      10_900_091,
      10_900_092,
      10_900_198,
      01_000_011,
      01_000_012,
      10_900_094,
      01_000_013,
      10_900_201,
      10_900_095,
      01_000_014,
      10_900_203,
      10_900_151,
      10_900_205,
      10_900_153,
      10_900_207,
      10_900_101,
      10_900_261,
      10_900_155,
      10_900_103,
      10_900_157,
      10_900_051,
      10_900_211,
      10_900_105,
      10_900_212,
      10_900_107,
      10_900_001,
      10_900_213,
      10_900_161,
      10_900_214,
      10_900_111,
      20_000_001,
      10_900_061,
      10_900_221,
      10_900_062,
      10_900_222,
      10_900_063,
      10_900_011,
      10_900_223,
      10_900_171,
      10_900_065,
      10_900_225,
      10_900_173,
      10_900_281,
      10_900_175,
      20_000_011,
      10_900_071,
      10_900_177,
      10_900_231,
      10_900_072,
      10_900_021,
      10_900_074,
      10_900_181,
      10_900_076,
      10_900_131,
      10_900_291,
      10_900_292,
      10_900_081,
      10_900_293,
      10_900_294,
      01_000_001,
      10_900_031,
      10_900_191,
      10_900_032,
      01_000_003,
      10_900_163,
      10_900_232,
      10_900_251,
      10_900_271,
      10_900_121,
      10_900_241,
      10_900_141,
      10_900_041
    ],
    striker: [
      11_000_312,
      11_000_101,
      11_000_313,
      11_000_261,
      11_000_262,
      11_000_051,
      11_000_316,
      11_000_211,
      11_000_053,
      11_000_265,
      11_000_212,
      11_000_001,
      11_000_266,
      11_000_213,
      11_000_214,
      11_000_161,
      11_000_055,
      11_000_321,
      11_000_271,
      11_000_272,
      11_000_061,
      11_000_011,
      11_000_171,
      11_000_012,
      11_000_121,
      11_000_281,
      11_000_282,
      20_000_001,
      11_000_283,
      11_000_021,
      11_000_181,
      11_000_341,
      11_000_182,
      11_000_183,
      11_000_131,
      11_000_132,
      11_000_026,
      11_000_081,
      20_000_011,
      11_000_241,
      11_000_031,
      11_000_191,
      11_000_032,
      11_000_192,
      11_000_141,
      11_000_091,
      11_000_144,
      11_000_041,
      11_000_042,
      11_000_071,
      11_000_311,
      11_000_331,
      11_000_314,
      11_000_111,
      11_000_231,
      11_000_267,
      11_000_082,
      11_000_219,
      11_000_151,
      11_000_221,
      11_000_291
    ],
    soul_binder: [
      11_100_111,
      11_100_112,
      11_100_271,
      11_100_061,
      11_100_062,
      11_100_221,
      11_100_011,
      11_100_171,
      11_100_121,
      11_100_281,
      11_100_071,
      11_100_231,
      11_100_072,
      11_100_232,
      11_100_073,
      11_100_074,
      11_100_021,
      11_100_181,
      11_100_075,
      11_100_022,
      11_100_023,
      11_100_024,
      11_100_131,
      11_100_025,
      11_100_184,
      11_100_132,
      11_100_292,
      11_100_133,
      11_100_081,
      11_100_134,
      20_000_001,
      11_100_241,
      11_100_135,
      11_100_082,
      01_200_001,
      11_100_242,
      11_100_083,
      01_200_002,
      11_100_084,
      11_100_191,
      01_200_003,
      11_100_244,
      11_100_085,
      11_100_192,
      01_200_004,
      11_100_193,
      01_200_005,
      11_100_141,
      11_100_089,
      11_100_091,
      20_000_011,
      01_200_011,
      11_100_041,
      01_200_012,
      11_100_201,
      01_200_013,
      11_100_202,
      01_200_014,
      01_200_015,
      11_100_151,
      11_100_311,
      11_100_153,
      11_100_101,
      11_100_154,
      11_100_261,
      11_100_102,
      11_100_155,
      11_100_103,
      11_100_315,
      11_100_156,
      11_100_051,
      11_100_104,
      11_100_105,
      11_100_031,
      11_100_321,
      11_100_204,
      11_100_187,
      11_100_272,
      11_100_001,
      11_100_291,
      11_100_002,
      11_100_173,
      11_100_243,
      11_100_211,
      11_100_262,
      11_100_161,
      11_100_301,
      11_100_063,
      11_100_251
    ],
    game_master: [0]
  }

  def ordered_skill_ids(job), do: Map.get(@orders, job)

  def set_skills(job, attrs \\ %{}) do
    # Reorder skills according to the character job
    ordered_ids = ordered_skill_ids(job)

    skills =
      Enum.map(ordered_ids, fn skill_id ->
        metadata = Metadata.get(Metadata.Skill, skill_id)
        level = metadata.levels["1"].condition.level
        %{skill_id: skill_id, level: level}
      end)

    Map.put(attrs, :skills, skills)
  end
end
